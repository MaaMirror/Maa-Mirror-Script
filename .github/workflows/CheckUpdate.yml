name: Check

on:
    workflow_call:

    workflow_dispatch:

jobs:
    run:
      runs-on: ubuntu-latest
      steps:
        - name: Checkout Code
          uses: actions/checkout@v4

        - name: Setup Python
          uses: actions/setup-python@v5
          with:
            python-version: "3.12"

        - name: Install Deps
          run: |
            pip install -r requirements.txt

        - name: Run check
          id: run
          run: |
            python index.py --check --token ${{ secrets.GITHUB_TOKEN }}
            echo "updatable=${{ env.updatable }}" >> "$GITHUB_OUTPUT"
            echo "ver=${{ env.ver }}" >> "$GITHUB_OUTPUT"

      outputs:
        updatable: ${{ steps.run.outputs.updatable }}
        ver: ${{ steps.run.outputs.ver }}